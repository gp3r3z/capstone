import{x as G,A as d,l,y as C,_ as M,r as R,w as I,b as m,z as p,P as i,C as B,B as j,c as n,a as o,n as S,D as _,t as f,F as g,h as y,e as A,f as L,v as D,u as O,o as r,i as w,k as E}from"./index.35fba05f.js";class P{async getCommentsByGroupId(a){const u=await G.get(`api/groups/${a}/comments`);d.comments=u.data}async postComment(a,u){const t=await G.post(`api/comments/${u}`,a);l.log("comment data",t.data)}}const x=new P;class k{static EnterGroupChat(a){C.emit("ENTER_GROUPCHAT",a)}static LeaveGroupChat(a){C.emit("LEAVE_GROUPCHAT",a)}}const N={setup(){const c=O(),a=R({});async function u(){try{await p.getGroupById(c.params.id)}catch(e){i.error(e),l.log(e)}}async function t(){try{await p.getGroupMembersByGroupId(c.params.id)}catch(e){i.error("[ERROR]",e.message),l.log(e)}}async function b(){try{await p.getEventsByGroupId(c.params.id)}catch(e){console.error(e),i.error("[ERROR]",e.message),l.log(e)}}async function h(){try{await x.getCommentsByGroupId(c.params.id)}catch(e){console.error(e),i.error("[ERROR]",e.message)}}return I(()=>{u(),t(),b(),h(),d.activeEvent}),{editable:a,activeGroup:m(()=>d.activeGroup),foundMe:m(()=>d.groupMembers.find(e=>e.accountId==d.account.id)),account:m(()=>d.account),groupMembers:m(()=>d.groupMembers),events:m(()=>d.events),comments:m(()=>d.comments),async joinGroup(){try{l.log("Attempting to join group"),await p.joinGroup(c.params.id),i.success(`Joined Group!
Message Service Activated`)}catch(e){i.error("Unable to join Group: ",e),l.log(e)}},async leaveGroup(e){try{l.log("Attempting to leave group",e),await i.confirm("Are you sure you want to leave this group?")&&await p.leaveGroup(e)}catch(v){i.error(v),l.log(v)}},async enterGroupChat(){try{k.EnterGroupChat(c.params.id)}catch(e){i.error(e),l.log(e)}},async leaveGroupChat(){try{k.LeaveGroupChat(c.params.id)}catch(e){i.error(e),l.log(e)}},async postComment(){try{await x.postComment(a.value,c.params.id),a.value={}}catch(e){i.error("[ERROR]",e.message)}}}},components:{Comment:B,GroupEvent:j}},V={class:"container-fluid"},T={class:"row justify-content-center"},U={class:"col-1 mt-3"},H={key:0,type:"button",class:"btn btn-light","data-bs-toggle":"modal","data-bs-target":"#edit-group-modal"},z=o("i",{class:"mdi mdi-pencil fs-3 text-warning text-end fw-bold"},null,-1),F=[z],J={class:"row justify-content-around mt-3"},q={class:"col-6 bg-dark p-3 rounded"},K={class:"col-5 p-3 rounded"},Q={key:0},W={key:1},X={key:2},Y={key:3},Z=o("button",{class:"btn btn-danger ms-3",disabled:""},"Group is full",-1),$=[Z],tt={class:"row mx-4 p-2 rounded"},ot=o("span",{class:"d-flex justify-content-center align-items-center fst-italic fw-bold text-white fs-4"},"Group Members:",-1),et=["src","title"],at={class:"row bg-white mt-5 mx-5"},st={class:"d-flex"},nt={class:"row"},rt=o("i",{class:"mdi mdi-chat fs-1"},null,-1),ct=[rt],it={class:"offcanvas offcanvas-start bg-secondary",tabindex:"-1",id:"offcanvasExample","aria-labelledby":"offcanvasExampleLabel"},lt={class:"offcanvas-header"},dt=o("h5",{class:"offcanvas-title",id:"offcanvasExampleLabel"},"Group Chat",-1),ut={class:"offcanvas-body"},mt={class:"row"},pt={class:"col-11"},vt=o("button",{class:"btn-btn-primary"},[o("i",{class:"mdi mdi-plus"})],-1),_t={class:"row"},ft={key:0,href:"#",class:"float-right btn rounded-circle bg-dark d-flex justify-content-center align-items-center","data-bs-toggle":"modal","data-bs-target":"#create-event-modal",title:"Create Event"},gt=o("i",{class:"mdi mdi-gamepad-variant fs-1"},null,-1),yt=[gt];function bt(c,a,u,t,b,h){const e=E("GroupEvent"),v=E("Comment");return r(),n("section",V,[o("section",T,[o("div",{class:"col-9 hero-img rounded mt-3",style:S(`background-image: url(${t.activeGroup.coverImg})`)},null,4),o("div",U,[t.activeGroup.creatorId===t.account.id?(r(),n("button",H,F)):_("",!0)])]),o("section",J,[o("div",q,[o("h2",null,"Group: "+f(t.activeGroup.groupName),1),o("p",null,"Description: "+f(t.activeGroup.description),1),o("p",null,"Capacity: "+f(t.activeGroup.capacity),1),o("p",null,"SkillLevel: "+f(t.activeGroup.skillLevel),1)]),o("div",K,[t.account.id==t.activeGroup.creatorId?(r(),n("div",Q)):t.account.id&&!t.foundMe&&t.activeGroup.capacity>0?(r(),n("div",W,[o("button",{onClick:a[0]||(a[0]=(...s)=>t.joinGroup&&t.joinGroup(...s)),class:"btn btn-primary"},"Join")])):t.foundMe?(r(),n("div",X,[o("button",{onClick:a[1]||(a[1]=s=>t.leaveGroup(t.foundMe.id)),class:"btn btn-danger ms-3"},"Leave")])):!t.foundMe&&t.activeGroup.capacity==0?(r(),n("div",Y,$)):_("",!0)])]),o("section",tt,[ot,(r(!0),n(g,null,y(t.groupMembers,s=>(r(),n("div",null,[o("div",null,[o("img",{src:s.profile.picture,alt:"",title:s.profile.name,class:"group-member-picture rounded-circle"},null,8,et)])]))),256))]),o("section",at,[(r(!0),n(g,null,y(t.events,s=>(r(),n("div",st,[w(e,{event:s},null,8,["event"])]))),256))]),o("section",nt,[t.foundMe||t.account.id==t.activeGroup.creatorId?(r(),n("button",{key:0,onClick:a[2]||(a[2]=(...s)=>t.enterGroupChat&&t.enterGroupChat(...s)),class:"btn-primary float-left btn rounded-circle bg-dark d-flex justify-content-start align-items-start",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasExample","aria-controls":"offcanvasExample"},ct)):_("",!0)]),o("div",it,[o("div",lt,[dt,o("button",{onClick:a[3]||(a[3]=(...s)=>t.leaveGroupChat&&t.leaveGroupChat(...s)),type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})]),o("div",ut,[o("div",null,[o("section",mt,[(r(!0),n(g,null,y(t.comments,s=>(r(),n("div",pt,[w(v,{comment:s},null,8,["comment"])]))),256)),o("div",null,[o("form",{onSubmit:a[5]||(a[5]=A(s=>t.postComment(),["prevent"]))},[L(o("textarea",{"onUpdate:modelValue":a[4]||(a[4]=s=>t.editable.description=s),name:"Chat....",id:"",cols:"30",rows:"10"},null,512),[[D,t.editable.description]]),vt],32)])])])])]),o("section",_t,[t.foundMe||t.activeGroup.creatorId==t.account.id?(r(),n("button",ft,yt)):_("",!0)])])}const Gt=M(N,[["render",bt]]);export{Gt as default};
