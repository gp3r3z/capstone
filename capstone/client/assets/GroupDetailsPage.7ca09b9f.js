import{x as G,A as d,l,y as C,_ as R,r as B,w as I,b as m,z as v,P as i,C as j,B as L,c as n,a as t,n as w,D as f,t as p,F as g,h,e as S,f as A,v as D,u as O,o as r,i as E,k}from"./index.47f17861.js";class P{async getCommentsByGroupId(a){const u=await G.get(`api/groups/${a}/comments`);d.comments=u.data}async postComment(a,u){const o=await G.post(`api/comments/${u}`,a);l.log("comment data",o.data)}}const x=new P;class M{static EnterGroupChat(a){C.emit("ENTER_GROUPCHAT",a)}static LeaveGroupChat(a){C.emit("LEAVE_GROUPCHAT",a)}}const N={setup(){const c=O(),a=B({});async function u(){try{await v.getGroupById(c.params.id)}catch(e){i.error(e),l.log(e)}}async function o(){try{await v.getGroupMembersByGroupId(c.params.id)}catch(e){i.error("[ERROR]",e.message),l.log(e)}}async function b(){try{await v.getEventsByGroupId(c.params.id)}catch(e){console.error(e),i.error("[ERROR]",e.message),l.log(e)}}async function y(){try{await x.getCommentsByGroupId(c.params.id)}catch(e){console.error(e),i.error("[ERROR]",e.message)}}return I(()=>{u(),o(),b(),y(),d.activeEvent}),{editable:a,activeGroup:m(()=>d.activeGroup),foundMe:m(()=>d.groupMembers.find(e=>e.accountId==d.account.id)),account:m(()=>d.account),groupMembers:m(()=>d.groupMembers),events:m(()=>d.events),comments:m(()=>d.comments),async joinGroup(){try{l.log("Attempting to join group"),await v.joinGroup(c.params.id),i.success(`Joined Group!
Message Service Activated`)}catch(e){i.error("Unable to join Group: ",e),l.log(e)}},async leaveGroup(e){try{l.log("Attempting to leave group",e),await i.confirm("Are you sure you want to leave this group?")&&await v.leaveGroup(e)}catch(_){i.error(_),l.log(_)}},async enterGroupChat(){try{M.EnterGroupChat(c.params.id)}catch(e){i.error(e),l.log(e)}},async leaveGroupChat(){try{M.LeaveGroupChat(c.params.id)}catch(e){i.error(e),l.log(e)}},async postComment(){try{await x.postComment(a.value,c.params.id),a.value={}}catch(e){i.error("[ERROR]",e.message)}}}},components:{Comment:j,GroupEvent:L}},U={class:"container-fluid"},V={class:"row justify-content-center"},T={class:"col-1 mt-3"},H={key:0,type:"button",class:"btn btn-light","data-bs-toggle":"modal","data-bs-target":"#edit-group-modal"},z=t("i",{class:"mdi mdi-pencil fs-3 text-warning text-end fw-bold"},null,-1),F=[z],J={class:"row justify-content-around mt-3"},q={class:"col-6 bg-dark p-3 rounded"},K={class:"col-5 p-3 rounded"},Q={key:0},W={key:1},X={key:2},Y=t("button",{class:"btn btn-danger ms-3",disabled:""},"Group is full",-1),Z=[Y],$={class:"row mx-4 p-2 rounded bg-light mt-3"},tt=t("span",{class:"d-flex justify-content-center align-items-center fst-italic fw-bold text-white fs-4"},"Group Members:",-1),ot={class:"col-2 mt-3"},et={ontouchstart:"this.classList.toggle('hover');"},at={class:"container"},st={class:"inner"},nt={class:"back"},rt={class:"inner"},ct={class:"row mt-3 rounded"},it={class:"col-4"},lt={class:"row"},dt=t("i",{class:"mdi mdi-chat fs-1"},null,-1),ut=[dt],mt={class:"offcanvas offcanvas-start bg-secondary",tabindex:"-1",id:"offcanvasExample","aria-labelledby":"offcanvasExampleLabel"},pt={class:"offcanvas-header"},vt=t("h5",{class:"offcanvas-title",id:"offcanvasExampleLabel"},"Group Chat",-1),_t={class:"offcanvas-body"},ft={class:"row"},gt={class:"col-11"},ht=t("button",{class:"btn-btn-primary"},[t("i",{class:"mdi mdi-plus"})],-1),bt={class:"row"},yt={key:0,href:"#",class:"float-right btn rounded-circle bg-dark d-flex justify-content-center align-items-center","data-bs-toggle":"modal","data-bs-target":"#create-event-modal",title:"Create Event"},Gt=t("i",{class:"mdi mdi-gamepad-variant fs-1"},null,-1),Ct=[Gt];function wt(c,a,u,o,b,y){const e=k("GroupEvent"),_=k("Comment");return r(),n("section",U,[t("section",V,[t("div",{class:"col-9 hero-img rounded mt-3",style:w(`background-image: url(${o.activeGroup.coverImg})`)},null,4),t("div",T,[o.activeGroup.creatorId===o.account.id?(r(),n("button",H,F)):f("",!0)])]),t("section",J,[t("div",q,[t("h2",null,"Group: "+p(o.activeGroup.groupName),1),t("p",null,"Description: "+p(o.activeGroup.description),1),t("p",null,"Capacity: "+p(o.activeGroup.capacity),1),t("p",null,"SkillLevel: "+p(o.activeGroup.skillLevel),1)]),t("div",K,[o.account.id!=o.activeGroup.creatorId&&!o.foundMe&&o.activeGroup.capacity>0?(r(),n("div",Q,[t("button",{onClick:a[0]||(a[0]=(...s)=>o.joinGroup&&o.joinGroup(...s)),class:"btn btn-primary"},"Join")])):o.foundMe?(r(),n("div",W,[t("button",{onClick:a[1]||(a[1]=s=>o.leaveGroup(o.foundMe.id)),class:"btn btn-danger ms-3"},"Leave Group")])):!o.foundMe&&o.activeGroup.capacity==0?(r(),n("div",X,Z)):f("",!0)])]),t("section",$,[tt,(r(!0),n(g,null,h(o.groupMembers,s=>(r(),n("div",ot,[t("div",et,[t("div",at,[t("div",{class:"front",style:w(`background-image: url(${s.profile.picture})`)},[t("div",st,[t("p",null,p(s.profile.name),1)])],4),t("div",nt,[t("div",rt,[t("p",null,p(s.profile.bio?s.profile.bio:"User has no Bio"),1)])])])])]))),256))]),t("section",ct,[(r(!0),n(g,null,h(o.events,s=>(r(),n("div",it,[E(e,{event:s},null,8,["event"])]))),256))]),t("section",lt,[o.foundMe||o.account.id==o.activeGroup.creatorId?(r(),n("button",{key:0,onClick:a[2]||(a[2]=(...s)=>o.enterGroupChat&&o.enterGroupChat(...s)),class:"btn-primary float-left btn rounded-circle bg-dark d-flex justify-content-start align-items-start",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasExample","aria-controls":"offcanvasExample"},ut)):f("",!0)]),t("div",mt,[t("div",pt,[vt,t("button",{onClick:a[3]||(a[3]=(...s)=>o.leaveGroupChat&&o.leaveGroupChat(...s)),type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})]),t("div",_t,[t("div",null,[t("section",ft,[(r(!0),n(g,null,h(o.comments,s=>(r(),n("div",gt,[E(_,{comment:s},null,8,["comment"])]))),256)),t("div",null,[t("form",{onSubmit:a[5]||(a[5]=S(s=>o.postComment(),["prevent"]))},[A(t("textarea",{"onUpdate:modelValue":a[4]||(a[4]=s=>o.editable.description=s),name:"Chat....",id:"",cols:"30",rows:"10"},null,512),[[D,o.editable.description]]),ht],32)])])])])]),t("section",bt,[o.foundMe||o.activeGroup.creatorId==o.account.id?(r(),n("button",yt,Ct)):f("",!0)])])}const kt=R(N,[["render",wt]]);export{kt as default};
